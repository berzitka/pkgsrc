$NetBSD: patch-aq,v 1.1 2010/09/16 12:02:05 taca Exp $

* Keep backward compatible with 1.3.5 for "gem spec" output.

--- lib/rubygems/dependency.rb.orig	2010-04-20 05:57:25.000000000 +0000
+++ lib/rubygems/dependency.rb
@@ -58,14 +58,14 @@ class Gem::Dependency
     end
 
     @name        = name
-    @requirement = Gem::Requirement.create requirements
+    requirement = Gem::Requirement.create requirements
     @type        = type
     @prerelease  = false
 
     # This is for Marshal backwards compatability. See the comments in
     # +requirement+ for the dirty details.
 
-    @version_requirements = @requirement
+    @version_requirements = requirement
   end
 
   ##
@@ -107,7 +107,10 @@ class Gem::Dependency
   # What does this dependency require?
 
   def requirement
-    return @requirement if defined?(@requirement) and @requirement
+    if defined?(@requirement) and @requirement
+      @version_requirements = @requirement
+      remove_instance_variable :@requirement
+    end
 
     # @version_requirements and @version_requirement are legacy ivar
     # names, and supported here because older gems need to keep
@@ -130,7 +133,7 @@ class Gem::Dependency
       @version_requirements = Gem::Requirement.new version
     end
 
-    @requirement = @version_requirements if defined?(@version_requirements)
+    @version_requirements if defined?(@version_requirements)
   end
 
   ##
@@ -168,7 +171,7 @@ class Gem::Dependency
          "and will be removed on or after August 2010.  " \
          "Use Gem::Dependency.new."
 
-    @requirement = Gem::Requirement.create requirements
+    @version_requirements = Gem::Requirement.create requirements
   end
 
   def == other # :nodoc:
