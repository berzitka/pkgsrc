$NetBSD: patch-ax,v 1.2 2010/01/29 18:19:09 adam Exp $

--- src/3rdparty/webkit/WebCore/websockets/WebSocketHandshake.cpp.orig	2010-01-28 06:27:43.000000000 +0000
+++ src/3rdparty/webkit/WebCore/websockets/WebSocketHandshake.cpp
@@ -252,7 +252,11 @@ int WebSocketHandshake::readServerHandsh
         p += sizeof(webSocketConnectionHeader) - 1;
     }
 
+#if defined(__NetBSD__)
+    if (!strstr(p, "\r\n\r\n")) {
+#else
     if (!strnstr(p, "\r\n\r\n", end - p)) {
+#endif
         // Just hasn't been received fully yet.
         return -1;
     }
