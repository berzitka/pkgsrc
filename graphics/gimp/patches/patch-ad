$NetBSD: patch-ad,v 1.9 2010/06/20 14:01:59 wiz Exp $

https://bugzilla.gnome.org/show_bug.cgi?id=622198

--- plug-ins/file-ico/ico-load.c.orig	2009-07-20 20:20:51.000000000 +0000
+++ plug-ins/file-ico/ico-load.c
@@ -287,14 +287,14 @@ ico_read_png (FILE    *fp,
   switch (color_type)
     {
     case PNG_COLOR_TYPE_GRAY:
-      png_set_gray_1_2_4_to_8 (png_ptr);
+      png_set_expand_gray_1_2_4_to_8 (png_ptr);
       if ( bit_depth == 16 )
         png_set_strip_16 (png_ptr);
       png_set_gray_to_rgb (png_ptr);
       png_set_add_alpha (png_ptr, 0xff, PNG_FILLER_AFTER);
       break;
     case PNG_COLOR_TYPE_GRAY_ALPHA:
-      png_set_gray_1_2_4_to_8 (png_ptr);
+      png_set_expand_gray_1_2_4_to_8 (png_ptr);
       if ( bit_depth == 16 )
         png_set_strip_16 (png_ptr);
       png_set_gray_to_rgb (png_ptr);
