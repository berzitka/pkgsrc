$NetBSD: patch-ad,v 1.9 2010/10/12 19:50:35 joerg Exp $

Fix unportable test construct.
LD_PRELOAD is supported on DragonFly.

--- configure.ac.orig	2010-09-06 12:11:22.000000000 +0000
+++ configure.ac
@@ -99,7 +99,7 @@ CAIRO_ENABLE_SURFACE_BACKEND(xcb, XCB, n
 ])
 
 CAIRO_ENABLE_FUNCTIONS(xlib_xcb, Xlib/XCB, no, [
-  if test "x$use_xcb" == "xyes" -a "x$use_xlib" == "xyes"; then
+  if test "x$use_xcb" = "xyes" -a "x$use_xlib" = "xyes"; then
     xlib_xcb_REQUIRES="x11-xcb"
     PKG_CHECK_MODULES(xlib_xcb, $xlib_xcb_REQUIRES, ,
 		      [use_xlib_xcb="no (requires $xlib_xcb_REQUIRES http://xcb.freedesktop.org)"])
@@ -110,7 +110,7 @@ CAIRO_ENABLE_FUNCTIONS(xlib_xcb, Xlib/XC
 AM_CONDITIONAL(BUILD_XLIB_XCB, test "x$use_xlib_xcb" = "xyes")
 
 CAIRO_ENABLE_FUNCTIONS(xcb_shm, XCB/SHM, auto, [
-  if test "x$use_xcb" == "xyes"; then
+  if test "x$use_xcb" = "xyes"; then
       xcb_shm_REQUIRES="xcb-shm"
       PKG_CHECK_MODULES(xcb_shm, $xcb_shm_REQUIRES, ,
 			[AC_MSG_RESULT(no)
@@ -232,7 +232,7 @@ CAIRO_ENABLE_SURFACE_BACKEND(drm, DRM, n
 ])
 
 CAIRO_ENABLE_FUNCTIONS(drm_xr, DRM Xr (DDX), no, [
-  if test "x$use_drm" == "xyes"; then
+  if test "x$use_drm" = "xyes"; then
       drm_xr_REQUIRES="xorg-server >= 1.6 xproto xextproto >= 7.0.99.1 renderproto x11"
       PKG_CHECK_MODULES(drm_xr, $drm_xr_REQUIRES, ,
 			[AC_MSG_RESULT(no)
@@ -262,7 +262,7 @@ CAIRO_ENABLE_SURFACE_BACKEND(gallium, Ga
 ])
 
 CAIRO_ENABLE_FUNCTIONS(xcb_drm, XCB/DRM, no, [
-  if test "x$use_xcb" == "xyes" -a "x$use_drm" == "xyes"; then
+  if test "x$use_xcb" = "xyes" -a "x$use_drm" = "xyes"; then
       xcb_drm_REQUIRES="xcb-dri2"
       PKG_CHECK_MODULES(xcb_drm, $xcb_drm_REQUIRES, ,
 			[AC_MSG_RESULT(no)
@@ -708,7 +708,7 @@ dnl The tracing utility requires LD_PREL
 dnl that are known to work.
 
 case $host in
-*-linux*|*-*bsd*|*-solaris*|*-*-darwin*)
+*-linux*|*-*bsd*|*-solaris*|*-*-darwin*|*-dragonfly*)
 	have_ld_preload="yes"
 	;;
 *)
