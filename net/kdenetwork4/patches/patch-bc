$NetBSD: patch-bc,v 1.1 2010/05/16 21:21:39 markd Exp $

--- kget/ui/metalinkcreator/metalinker.h.orig	2010-01-31 19:33:11.000000000 +0000
+++ kget/ui/metalinkcreator/metalinker.h
@@ -259,6 +259,14 @@ class File
         KIO::filesize_t size;
         CommonData data;
         Resources resources;
+
+    private:
+        /**
+         * Controlls if the name attribute is valid, i.e. it is not empty and
+         * does not contain any directory traversal directives or information,
+         * as described in the Metalink 4.0 specification 4.1.2.1.
+         */
+        bool isValidNameAttribute() const;
 };
 
 class Files
