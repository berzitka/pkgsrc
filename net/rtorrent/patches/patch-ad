$NetBSD: patch-ad,v 1.3 2012/05/16 17:42:37 tron Exp $

Fix build under Solaris and DragonFly.

--- src/utils/directory.cc.orig	2012-03-29 14:06:11.000000000 +0100
+++ src/utils/directory.cc	2012-05-14 23:44:08.000000000 +0100
@@ -38,6 +38,7 @@
 
 #include <algorithm>
 #include <functional>
+#include <sys/stat.h>
 #include <dirent.h>
 #include <rak/path.h>
 #include <torrent/exceptions.h>
@@ -67,7 +68,9 @@
   if (m_path.empty())
     throw torrent::input_error("Directory::update() tried to open an empty path.");
 
-  DIR* d = opendir(rak::path_expand(m_path).c_str());
+  std::string path=rak::path_expand(m_path);
+
+  DIR* d = opendir(path.c_str());
 
   if (d == NULL)
     return false;
