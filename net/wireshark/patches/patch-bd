$NetBSD: patch-bd,v 1.1 2011/12/10 18:55:38 roy Exp $

Fix ICMPv6 DNSSL padding

--- epan/dissectors/packet-icmpv6.c.orig	2011-12-10 13:44:00.000000000 +0000
+++ epan/dissectors/packet-icmpv6.c	2011-12-10 17:03:28.000000000 +0000
@@ -1940,7 +1940,11 @@
                 opt_offset += 4;
                 while(opt_offset < (offset + opt_len) ) {
 
-                    if(tvb_get_guint8(tvb, opt_offset) == 0){ /* if Zero there is padding, skip the loop */
+                    if(tvb_get_guint8(tvb, opt_offset) == 0){
+                        /* Padding... */
+                        int padd_length = (offset + opt_len) - opt_offset;
+                        proto_tree_add_item(icmp6opt_tree, hf_icmpv6_opt_padding, tvb, opt_offset, padd_length, FALSE);
+                        opt_offset += padd_length;
                         break;
                     }
                     dnssl_len = get_dns_name(tvb, opt_offset, 0, opt_offset, &dnssl_name);
