$NetBSD: patch-aa,v 1.3 2010/12/07 22:53:48 abs Exp $

--- if-bsd.c.orig	2010-12-05 21:31:47.000000000 +0000
+++ if-bsd.c
@@ -37,10 +37,12 @@
 #include <net/if_dl.h>
 #include <net/route.h>
 #include <netinet/in.h>
-#ifdef __DragonFly__
+#ifndef __APPLE__
+# ifdef __DragonFly__
 #  include <netproto/802_11/ieee80211_ioctl.h>
-#else
+# else
 #  include <net80211/ieee80211_ioctl.h>
+# endif
 #endif
 
 #include <errno.h>
@@ -342,6 +344,7 @@ manage_link(int fd)
 		for (p = link_buf; p < e; p += rtm->rtm_msglen) {
 			rtm = (struct rt_msghdr *)(void *)p;
 			switch(rtm->rtm_type) {
+#ifdef RTM_IFANNOUNCE
 			case RTM_IFANNOUNCE:
 				ifan = (struct if_announcemsghdr *)(void *)p;
 				switch(ifan->ifan_what) {
@@ -353,6 +356,7 @@ manage_link(int fd)
 					break;
 				}
 				break;
+#endif
 			case RTM_IFINFO:
 				ifm = (struct if_msghdr *)(void *)p;
 				memset(ifname, 0, sizeof(ifname));
